import{c as A,w as W,r as o,t as he,j as e,n as Q,x as $t,P as re,a as Ye,y as Se,u as Ke,d as xe,e as B,q as I,I as me,z as Xe,B as Le,A as Pe,b as Ft,g as Ot,D as zt,C as Bt,U as Ut,L as Ht,o as qt,E as k}from"./index-BpYIqvO7.js";import{P as Ee}from"./PaginationControls-B16WKjs3.js";import{L as Gt,T as Je}from"./textarea-JV2-VyBy.js";import{C as X,a as Me,b as De,c as $e,d as M,e as Vt}from"./card-l6itj-ep.js";import{B as Y}from"./badge-tSxXjzVC.js";import{u as Yt,R as Kt}from"./index-CmW4LDsW.js";import{u as Xt,b as Jt,c as We,R as Wt,A as Qt,a as Zt,C as ea}from"./index-D7GSWksB.js";import{F as ta}from"./index-CD1JQcn1.js";import"./ellipsis-BwrSFmOg.js";/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aa=[["path",{d:"M6 12h9a4 4 0 0 1 0 8H7a1 1 0 0 1-1-1V5a1 1 0 0 1 1-1h7a4 4 0 0 1 0 8",key:"mg9rjx"}]],ra=A("bold",aa);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const na=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],sa=A("calendar",na);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oa=[["path",{d:"m16 18 6-6-6-6",key:"eg8j8"}],["path",{d:"m8 6-6 6 6 6",key:"ppft3o"}]],ia=A("code",oa);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ca=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],Qe=A("eye",ca);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const la=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]],Ie=A("image",la);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const da=[["line",{x1:"19",x2:"10",y1:"4",y2:"4",key:"15jd3p"}],["line",{x1:"14",x2:"5",y1:"20",y2:"20",key:"bu0au3"}],["line",{x1:"15",x2:"9",y1:"4",y2:"20",key:"uljnxc"}]],ua=A("italic",da);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pa=[["path",{d:"M3 5h.01",key:"18ugdj"}],["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 19h.01",key:"noohij"}],["path",{d:"M8 5h13",key:"1pao27"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 19h13",key:"m83p4d"}]],ma=A("list",pa);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ha=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],Ze=A("pen",ha);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xa=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],ga=A("plus",xa);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fa=[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]],ya=A("star",fa);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ba=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],et=A("trash-2",ba);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const va=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],ja=A("upload",va);let Ca="http://articles.api.acosta.net.ar/api/v1/";const Na=Ca+"image/",wa=async(t,a,r)=>{console.log("Uploading image with tempIdToken:",a);const s=await W.post(Na,t,{headers:{"x-tempid-token":a,Authorization:`Bearer ${r}`}});return console.log("Upload response:",s.data),s.data},ka=()=>{const[t,a]=o.useState(null),[r,s]=o.useState(!1),[n,i]=o.useState(null),{token:u}=he(),f=o.useCallback(async(l,m)=>{s(!0);try{const d=await wa(l,m,u);return a(d),d}catch(d){throw i(d),d}finally{s(!1)}},[]);return{imageUrl:t,loading:r,error:n,uploadNewImage:f}};let Ta="http://articles.api.acosta.net.ar/api/v1/";const Pa=Ta+"tempid/",Ea=async t=>(await W.get(Pa,{headers:{Authorization:`Bearer ${t}`}})).data,Ia=()=>{const[t,a]=o.useState(null),[r,s]=o.useState(null),[n,i]=o.useState(!1),[u,f]=o.useState(null),{token:l}=he(),m=o.useCallback(async()=>{i(!0);try{const d=await Ea(l);a(d.tempId),s(d.token)}catch(d){f(d)}finally{i(!1)}},[l]);return o.useEffect(()=>{l?m():console.warn("No admin token available to fetch temp ID.")},[m,l]),{tempId:t,tempIdToken:r,loading:n,error:u,fetchTempId:m}},Aa="http://articles.api.acosta.net.ar/api/v1/",ge=Aa+"category",_a=async()=>(await W.get(ge)).data,Ra=async(t,a)=>(await W.post(ge,t,{headers:{Authorization:`Bearer ${a}`}})).data,Sa=async(t,a)=>(await W.put(`${ge}/${t.id}`,t,{headers:{Authorization:`Bearer ${a}`}})).data,La=async(t,a)=>{await W.delete(`${ge}/${t}`,{headers:{Authorization:`Bearer ${a}`}})},Ma=()=>{const[t,a]=o.useState([]),[r,s]=o.useState(!1),[n,i]=o.useState(null),{token:u}=he(),f=async()=>{s(!0);try{const x=await _a();a(x)}catch(x){i(x)}finally{s(!1)}},l=async x=>{s(!0);try{const h=await Ra(x,u);return a(g=>[...g,h]),h}catch(h){throw i(h),h}finally{s(!1)}},m=async x=>{s(!0);try{await La(x,u),a(h=>h.filter(g=>g.id!==x))}catch(h){throw i(h),h}finally{s(!1)}},d=async x=>{s(!0);try{const h=await Sa(x,u);return a(g=>g.map(j=>j.id===h.id?h:j)),h}catch(h){throw i(h),h}finally{s(!1)}};return o.useEffect(()=>{f()},[]),{categories:t,loading:r,error:n,fetchCategories:f,addCategory:l,removeCategory:m,updateCategoryData:d}},Da=$t("relative w-full rounded-lg border px-4 py-3 text-sm grid has-[>svg]:grid-cols-[calc(var(--spacing)*4)_1fr] grid-cols-[0_1fr] has-[>svg]:gap-x-3 gap-y-0.5 items-start [&>svg]:size-4 [&>svg]:translate-y-0.5 [&>svg]:text-current",{variants:{variant:{default:"bg-card text-card-foreground",destructive:"text-destructive bg-card [&>svg]:text-current *:data-[slot=alert-description]:text-destructive/90"}},defaultVariants:{variant:"default"}});function $a({className:t,variant:a,...r}){return e.jsx("div",{"data-slot":"alert",role:"alert",className:Q(Da({variant:a}),t),...r})}function Fa({className:t,...a}){return e.jsx("div",{"data-slot":"alert-title",className:Q("col-start-2 line-clamp-1 min-h-4 font-medium tracking-tight",t),...a})}function Oa({className:t,...a}){return e.jsx("div",{"data-slot":"alert-description",className:Q("text-muted-foreground col-start-2 grid justify-items-start gap-1 text-sm [&_p]:leading-relaxed",t),...a})}function za({tempIdError:t,articleError:a,imageError:r}){return!t&&!a&&!r?null:e.jsxs($a,{variant:"destructive",children:[e.jsx(Fa,{children:"Error"}),e.jsxs(Oa,{children:[t&&e.jsxs("div",{children:["TempID: ",t.message]}),a&&e.jsxs("div",{children:["Artículo: ",a.message]}),r&&e.jsxs("div",{children:["Imagen: ",r.message]})]})]})}var Ba="Label",tt=o.forwardRef((t,a)=>e.jsx(re.label,{...t,ref:a,onMouseDown:r=>{r.target.closest("button, input, select, textarea")||(t.onMouseDown?.(r),!r.defaultPrevented&&r.detail>1&&r.preventDefault())}}));tt.displayName=Ba;var Ua=tt;function $({className:t,...a}){return e.jsx(Ua,{"data-slot":"label",className:Q("flex items-center gap-2 text-sm leading-none font-medium select-none group-data-[disabled=true]:pointer-events-none group-data-[disabled=true]:opacity-50 peer-disabled:cursor-not-allowed peer-disabled:opacity-50",t),...a})}var fe="Checkbox",[Ha]=Ye(fe),[qa,Fe]=Ha(fe);function Ga(t){const{__scopeCheckbox:a,checked:r,children:s,defaultChecked:n,disabled:i,form:u,name:f,onCheckedChange:l,required:m,value:d="on",internal_do_not_use_render:x}=t,[h,g]=Ke({prop:r,defaultProp:n??!1,onChange:l,caller:fe}),[j,w]=o.useState(null),[N,v]=o.useState(null),C=o.useRef(!1),E=j?!!u||!!j.closest("form"):!0,T={checked:h,disabled:i,setChecked:g,control:j,setControl:w,name:f,form:u,value:d,hasConsumerStoppedPropagationRef:C,required:m,defaultChecked:U(n)?!1:n,isFormControl:E,bubbleInput:N,setBubbleInput:v};return e.jsx(qa,{scope:a,...T,children:Va(x)?x(T):s})}var at="CheckboxTrigger",rt=o.forwardRef(({__scopeCheckbox:t,onKeyDown:a,onClick:r,...s},n)=>{const{control:i,value:u,disabled:f,checked:l,required:m,setControl:d,setChecked:x,hasConsumerStoppedPropagationRef:h,isFormControl:g,bubbleInput:j}=Fe(at,t),w=xe(n,d),N=o.useRef(l);return o.useEffect(()=>{const v=i?.form;if(v){const C=()=>x(N.current);return v.addEventListener("reset",C),()=>v.removeEventListener("reset",C)}},[i,x]),e.jsx(re.button,{type:"button",role:"checkbox","aria-checked":U(l)?"mixed":l,"aria-required":m,"data-state":lt(l),"data-disabled":f?"":void 0,disabled:f,value:u,...s,ref:w,onKeyDown:B(a,v=>{v.key==="Enter"&&v.preventDefault()}),onClick:B(r,v=>{x(C=>U(C)?!0:!C),j&&g&&(h.current=v.isPropagationStopped(),h.current||v.stopPropagation())})})});rt.displayName=at;var nt=o.forwardRef((t,a)=>{const{__scopeCheckbox:r,name:s,checked:n,defaultChecked:i,required:u,disabled:f,value:l,onCheckedChange:m,form:d,...x}=t;return e.jsx(Ga,{__scopeCheckbox:r,checked:n,defaultChecked:i,disabled:f,required:u,onCheckedChange:m,name:s,form:d,value:l,internal_do_not_use_render:({isFormControl:h})=>e.jsxs(e.Fragment,{children:[e.jsx(rt,{...x,ref:a,__scopeCheckbox:r}),h&&e.jsx(ct,{__scopeCheckbox:r})]})})});nt.displayName=fe;var st="CheckboxIndicator",ot=o.forwardRef((t,a)=>{const{__scopeCheckbox:r,forceMount:s,...n}=t,i=Fe(st,r);return e.jsx(Se,{present:s||U(i.checked)||i.checked===!0,children:e.jsx(re.span,{"data-state":lt(i.checked),"data-disabled":i.disabled?"":void 0,...n,ref:a,style:{pointerEvents:"none",...t.style}})})});ot.displayName=st;var it="CheckboxBubbleInput",ct=o.forwardRef(({__scopeCheckbox:t,...a},r)=>{const{control:s,hasConsumerStoppedPropagationRef:n,checked:i,defaultChecked:u,required:f,disabled:l,name:m,value:d,form:x,bubbleInput:h,setBubbleInput:g}=Fe(it,t),j=xe(r,g),w=Yt(i),N=Xt(s);o.useEffect(()=>{const C=h;if(!C)return;const E=window.HTMLInputElement.prototype,_=Object.getOwnPropertyDescriptor(E,"checked").set,b=!n.current;if(w!==i&&_){const P=new Event("click",{bubbles:b});C.indeterminate=U(i),_.call(C,U(i)?!1:i),C.dispatchEvent(P)}},[h,w,i,n]);const v=o.useRef(U(i)?!1:i);return e.jsx(re.input,{type:"checkbox","aria-hidden":!0,defaultChecked:u??v.current,required:f,disabled:l,name:m,value:d,form:x,...a,tabIndex:-1,ref:j,style:{...a.style,...N,position:"absolute",pointerEvents:"none",opacity:0,margin:0,transform:"translateX(-100%)"}})});ct.displayName=it;function Va(t){return typeof t=="function"}function U(t){return t==="indeterminate"}function lt(t){return U(t)?"indeterminate":t?"checked":"unchecked"}function Ve({className:t,...a}){return e.jsx(nt,{"data-slot":"checkbox",className:Q("peer border-input dark:bg-input/30 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground dark:data-[state=checked]:bg-primary data-[state=checked]:border-primary focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive size-4 shrink-0 rounded-[4px] border shadow-xs transition-shadow outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50",t),...a,children:e.jsx(ot,{"data-slot":"checkbox-indicator",className:"grid place-content-center text-current transition-none",children:e.jsx(Jt,{className:"size-3.5"})})})}function Ya({imageInputRef:t,onImageChange:a,onUpload:r,imageData:s,isUploadingImage:n}){return e.jsx("div",{className:"space-y-2 flex align-items-center gap-4",children:e.jsxs("div",{className:"flex gap-2 items-center ",children:[e.jsxs(I,{type:"button",size:"sm",variant:"outline",className:"gap-2 px-3",children:[e.jsx(me,{ref:t,id:"image",type:"file",name:"image",accept:"image/*",onChange:a,className:"hidden"}),e.jsxs("label",{htmlFor:"image",type:"button",className:"flex flex-row gap-2 align-items-center items-center",children:[e.jsx(Ie,{className:"h-4 w-4"}),e.jsx("span",{className:"text-sm text-muted-foreground ",children:s?"Change":"Upload Image"})]})]}),e.jsxs(I,{type:"button",disabled:n||!s,onClick:r,variant:"outline",size:"sm",className:"gap-2",children:[n?e.jsx(Xe,{className:"h-4 w-4 animate-spin"}):e.jsx(ja,{className:"h-4 w-4"}),e.jsx("span",{className:"hidden sm:inline",children:n?"Uploading...":"Confirm Upload"})]})]})})}function Ka({formData:t,onChange:a,bannerInputRef:r,imageInputRef:s,handleImageChange:n,handleImageUpload:i,imageData:u,isUploadingImage:f,handleSubmit:l,isSubmittingArticle:m,categories:d,selectedCategories:x,handleCategoryCheckbox:h,isEditing:g,cancelEditArticle:j,handleSubmitEdit:w}){const[N,v]=o.useState(null),[C,E]=o.useState(0),[T,_]=o.useState(12),[b,P]=o.useState(1),F=Math.ceil(d.length/T),se=d.slice(C,C+T),Z=y=>{P(y);const D=(y-1)*T;E(D)},H=y=>{y.preventDefault(),l(y),v(null)},q=y=>{y.preventDefault(),w(y),v(null)},G=()=>{j(),v(null)},oe=y=>{const D=y.target.files?.[0];if(D){const R=new FileReader;R.onload=S=>{v(S.target?.result)},R.readAsDataURL(D)}a(y)},O=(y,D="")=>{const R=document.getElementById("content"),S=R.selectionStart,ve=R.selectionEnd,ie=t.content.substring(S,ve),ce=t.content.substring(0,S)+y+ie+D+t.content.substring(ve);a({target:{name:"content",value:ce}}),setTimeout(()=>{R.focus(),R.selectionStart=S+y.length,R.selectionEnd=S+y.length+ie.length},0)},K=[{icon:ra,label:"Bold",onClick:()=>O("**","**")},{icon:ua,label:"Cursive",onClick:()=>O("*","*")},{icon:ia,label:"Code",onClick:()=>O("`","`")},{icon:Gt,label:"Link",onClick:()=>O("[texto](",")")},{icon:ma,label:"List",onClick:()=>O(`
- `,"")}];return o.useEffect(()=>{g&&t.banner&&v(typeof t.banner=="string"?`${Le}${t.banner}`:null)},[g,t.banner]),o.useEffect(()=>{b>F&&(P(y=>y>1?y-1:1),E(y=>y>T?y-T:0))},[F]),e.jsx("div",{className:"w-full mx-auto",children:e.jsx("form",{onSubmit:g?q:H,className:"space-y-6",children:e.jsxs(X,{className:"border-l-4 border-l-primary",children:[e.jsxs(Me,{children:[e.jsx(De,{className:"text-2xl",children:g?"Edit article":"Create new article"}),e.jsx($e,{children:g?"Update the content and settings of your article":"Fill in the details to publish a new article"})]}),e.jsx(M,{className:"space-y-4",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx($,{htmlFor:"title",className:"text-sm font-medium",children:"Title"}),e.jsx(me,{id:"title",type:"text",name:"title",placeholder:"E.g., The Future of Technology in Everyday Life",value:t.title,onChange:a,required:!0,className:"text-base"})]})}),e.jsxs(M,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx($,{htmlFor:"banner",className:"text-sm font-medium",children:"Banner Image"}),e.jsx("div",{className:"relative",children:e.jsx(me,{ref:r,id:"banner",type:"file",name:"banner",accept:"image/*",onChange:oe,className:"cursor-pointer"})})]}),N&&e.jsxs("div",{className:"relative w-full h-64 rounded-lg border-2 border-primary/20 overflow-hidden bg-muted",children:[e.jsx("img",{src:N,alt:"Banner preview",className:"w-full h-full object-cover"}),e.jsx("div",{className:"absolute top-2 right-2",children:e.jsxs(Y,{variant:"secondary",className:"flex items-center gap-1",children:[e.jsx(Qe,{className:"h-3 w-3"}),"Preview"]})})]})]}),e.jsxs(M,{className:"space-y-3",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx($,{className:"text-xs font-semibold text-muted-foreground",children:"Markdown Tools"}),e.jsxs("div",{className:"flex flex-wrap gap-1 p-3 bg-muted border border-input rounded-lg",children:[K.map(y=>e.jsx(I,{type:"button",variant:"outline",size:"sm",onClick:y.onClick,title:y.label,className:"h-9 w-9 p-0 hover:bg-primary hover:text-primary-foreground transition-colors",children:e.jsx(y.icon,{className:"h-4 w-4"})},y.label)),e.jsx(Pe,{orientation:"vertical",className:"mx-1"}),e.jsx(Ya,{imageInputRef:s,onImageChange:n,onUpload:i,imageData:u,isUploadingImage:f})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx($,{htmlFor:"content",className:"text-sm font-medium",children:"Article Content"}),e.jsx(Je,{id:"content",name:"content",placeholder:"Write your article here... You can use Markdown to format.",value:t.content,onChange:a,required:!0,className:"min-h-64 font-mono text-sm resize-vertical"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"You can use Markdown syntax to format your content."})]})]}),e.jsxs(M,{children:[e.jsx("div",{className:"space-y-2 mb-3",children:e.jsx($,{className:"text-sm font-medium",children:"Tags/Categories"})}),d.length===0?e.jsx("p",{className:"text-sm text-muted-foreground",children:"No categories available. Please create categories first."}):e.jsx("div",{className:"flex flex-wrap gap-3",children:se.map(y=>e.jsxs("div",{className:"flex items-center space-x-2 p-2 rounded-lg border border-input hover:bg-accent transition-colors",children:[e.jsx(Ve,{id:`cat-${y.id}`,checked:x.includes(y.id),onCheckedChange:()=>h({target:{value:y.id,checked:!x.includes(y.id)}})}),e.jsx($,{htmlFor:`cat-${y.id}`,className:"cursor-pointer font-medium text-sm",children:y.name})]},y.id))}),F>1&&e.jsx(Ee,{currentPage:b,totalPages:F,onPageChange:Z})]}),e.jsx(M,{children:e.jsxs("div",{className:"flex items-center space-x-3 p-3 rounded-lg border border-input hover:bg-accent/50 transition-colors cursor-pointer",children:[e.jsx(Ve,{id:"featured",checked:t.featured,onCheckedChange:y=>a({target:{name:"featured",value:y}})}),e.jsxs("div",{className:"flex-1",children:[e.jsx($,{htmlFor:"featured",className:"cursor-pointer font-medium text-sm",children:"Mark as Featured Article"}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Featured articles are highlighted on the homepage and in"})]})]})}),e.jsx(M,{children:e.jsxs("div",{className:"flex gap-2 pt-4 ",children:[e.jsxs(I,{type:"submit",disabled:m,size:"lg",className:"flex-1 cursor-pointer",children:[m&&e.jsx(Xe,{className:"mr-2 h-4 w-4 animate-spin"}),g?"Update Article":"Create Article"]}),g&&e.jsx(I,{type:"submit",disabled:m,size:"lg",variant:"outline",className:"flex-1 cursor-pointer",onClick:G,children:"Cancel"})]})})]})})})}function Xa({categoryForm:t,onCategoryFormChange:a,onCategorySubmit:r,onEditCategory:s,categories:n,categoryAmount:i,categoriesLoading:u,onDeleteCategory:f,isEditingCategory:l,onEditCategorySubmit:m}){return e.jsxs("div",{className:"w-full mx-auto space-y-6",children:[e.jsxs(X,{className:"border-l-4 border-l-primary",children:[e.jsxs(Me,{children:[e.jsxs(De,{className:"flex items-center gap-2",children:[e.jsx(ga,{className:"w-5 h-5"}),l?"Edit Category":"New Category"]}),e.jsx($e,{children:l?"Update the details of your category":"Create a new category to organize your articles"})]}),e.jsx(M,{children:e.jsxs("form",{onSubmit:l?m:r,className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx($,{htmlFor:"cat-name",className:"text-sm font-medium",children:"Name"}),e.jsx(me,{id:"cat-name",name:"name",placeholder:"E.g., Technology, Health, Lifestyle",value:t.name,onChange:a,required:!0,className:"transition-colors focus:ring-2"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx($,{htmlFor:"cat-desc",className:"text-sm font-medium",children:"Description"}),e.jsx(Je,{id:"cat-desc",name:"description",placeholder:"A brief description of the category",value:t.description,onChange:a,rows:3,className:"resize-none transition-colors focus:ring-2"})]}),e.jsxs("div",{className:"flex gap-2 pt-2",children:[e.jsx(I,{type:"submit",disabled:u,className:"flex-1",children:u?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-2 border-white border-t-transparent mr-2"}),l?"Updating...":"Creating..."]}):l?"Update Category":"Create Category"}),l&&e.jsx(I,{type:"button",variant:"outline",onClick:()=>s(null),children:"Cancel"})]})]})})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"px-1",children:[e.jsxs("h2",{className:"text-lg font-semibold tracking-tight",children:["Categories (",i,")"]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Manage your existing categories below."})]}),n.length===0?e.jsx(X,{className:"border-dashed",children:e.jsx(M,{className:"py-8 text-center",children:e.jsx("p",{className:"text-muted-foreground",children:"There are no categories yet. Create one to get started!"})})}):e.jsx("div",{className:"grid gap-2",children:n.map(d=>e.jsx(X,{className:"hover:shadow-md transition-all duration-200 group",children:e.jsx(M,{className:"py-4 px-4",children:e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"font-semibold text-sm truncate group-hover:text-primary transition-colors",children:d.name}),d.description&&e.jsx("p",{className:"text-xs text-muted-foreground mt-1 line-clamp-2",children:d.description})]}),e.jsxs("div",{className:"flex items-center gap-2 flex-shrink-0",children:[e.jsx(I,{onClick:()=>s(d),size:"sm",variant:"outline",className:"h-8 w-8 p-0 hover:bg-blue-50 hover:text-blue-600 hover:border-blue-300",children:e.jsx(Ze,{className:"h-4 w-4"})}),e.jsx(I,{size:"sm",variant:"destructive",onClick:()=>f(d.id),className:"h-8 w-8 p-0",children:e.jsx(et,{className:"h-4 w-4"})})]})]})})},d.id))})]})]})}var[ye]=Ye("Tooltip",[We]),be=We(),dt="TooltipProvider",Ja=700,Ae="tooltip.open",[Wa,Oe]=ye(dt),ut=t=>{const{__scopeTooltip:a,delayDuration:r=Ja,skipDelayDuration:s=300,disableHoverableContent:n=!1,children:i}=t,u=o.useRef(!0),f=o.useRef(!1),l=o.useRef(0);return o.useEffect(()=>{const m=l.current;return()=>window.clearTimeout(m)},[]),e.jsx(Wa,{scope:a,isOpenDelayedRef:u,delayDuration:r,onOpen:o.useCallback(()=>{window.clearTimeout(l.current),u.current=!1},[]),onClose:o.useCallback(()=>{window.clearTimeout(l.current),l.current=window.setTimeout(()=>u.current=!0,s)},[s]),isPointerInTransitRef:f,onPointerInTransitChange:o.useCallback(m=>{f.current=m},[]),disableHoverableContent:n,children:i})};ut.displayName=dt;var ae="Tooltip",[Qa,ne]=ye(ae),pt=t=>{const{__scopeTooltip:a,children:r,open:s,defaultOpen:n,onOpenChange:i,disableHoverableContent:u,delayDuration:f}=t,l=Oe(ae,t.__scopeTooltip),m=be(a),[d,x]=o.useState(null),h=Ft(),g=o.useRef(0),j=u??l.disableHoverableContent,w=f??l.delayDuration,N=o.useRef(!1),[v,C]=Ke({prop:s,defaultProp:n??!1,onChange:P=>{P?(l.onOpen(),document.dispatchEvent(new CustomEvent(Ae))):l.onClose(),i?.(P)},caller:ae}),E=o.useMemo(()=>v?N.current?"delayed-open":"instant-open":"closed",[v]),T=o.useCallback(()=>{window.clearTimeout(g.current),g.current=0,N.current=!1,C(!0)},[C]),_=o.useCallback(()=>{window.clearTimeout(g.current),g.current=0,C(!1)},[C]),b=o.useCallback(()=>{window.clearTimeout(g.current),g.current=window.setTimeout(()=>{N.current=!0,C(!0),g.current=0},w)},[w,C]);return o.useEffect(()=>()=>{g.current&&(window.clearTimeout(g.current),g.current=0)},[]),e.jsx(Wt,{...m,children:e.jsx(Qa,{scope:a,contentId:h,open:v,stateAttribute:E,trigger:d,onTriggerChange:x,onTriggerEnter:o.useCallback(()=>{l.isOpenDelayedRef.current?b():T()},[l.isOpenDelayedRef,b,T]),onTriggerLeave:o.useCallback(()=>{j?_():(window.clearTimeout(g.current),g.current=0)},[_,j]),onOpen:T,onClose:_,disableHoverableContent:j,children:r})})};pt.displayName=ae;var _e="TooltipTrigger",mt=o.forwardRef((t,a)=>{const{__scopeTooltip:r,...s}=t,n=ne(_e,r),i=Oe(_e,r),u=be(r),f=o.useRef(null),l=xe(a,f,n.onTriggerChange),m=o.useRef(!1),d=o.useRef(!1),x=o.useCallback(()=>m.current=!1,[]);return o.useEffect(()=>()=>document.removeEventListener("pointerup",x),[x]),e.jsx(Qt,{asChild:!0,...u,children:e.jsx(re.button,{"aria-describedby":n.open?n.contentId:void 0,"data-state":n.stateAttribute,...s,ref:l,onPointerMove:B(t.onPointerMove,h=>{h.pointerType!=="touch"&&!d.current&&!i.isPointerInTransitRef.current&&(n.onTriggerEnter(),d.current=!0)}),onPointerLeave:B(t.onPointerLeave,()=>{n.onTriggerLeave(),d.current=!1}),onPointerDown:B(t.onPointerDown,()=>{n.open&&n.onClose(),m.current=!0,document.addEventListener("pointerup",x,{once:!0})}),onFocus:B(t.onFocus,()=>{m.current||n.onOpen()}),onBlur:B(t.onBlur,n.onClose),onClick:B(t.onClick,n.onClose)})})});mt.displayName=_e;var ze="TooltipPortal",[Za,er]=ye(ze,{forceMount:void 0}),ht=t=>{const{__scopeTooltip:a,forceMount:r,children:s,container:n}=t,i=ne(ze,a);return e.jsx(Za,{scope:a,forceMount:r,children:e.jsx(Se,{present:r||i.open,children:e.jsx(Ot,{asChild:!0,container:n,children:s})})})};ht.displayName=ze;var J="TooltipContent",xt=o.forwardRef((t,a)=>{const r=er(J,t.__scopeTooltip),{forceMount:s=r.forceMount,side:n="top",...i}=t,u=ne(J,t.__scopeTooltip);return e.jsx(Se,{present:s||u.open,children:u.disableHoverableContent?e.jsx(gt,{side:n,...i,ref:a}):e.jsx(tr,{side:n,...i,ref:a})})}),tr=o.forwardRef((t,a)=>{const r=ne(J,t.__scopeTooltip),s=Oe(J,t.__scopeTooltip),n=o.useRef(null),i=xe(a,n),[u,f]=o.useState(null),{trigger:l,onClose:m}=r,d=n.current,{onPointerInTransitChange:x}=s,h=o.useCallback(()=>{f(null),x(!1)},[x]),g=o.useCallback((j,w)=>{const N=j.currentTarget,v={x:j.clientX,y:j.clientY},C=sr(v,N.getBoundingClientRect()),E=or(v,C),T=ir(w.getBoundingClientRect()),_=lr([...E,...T]);f(_),x(!0)},[x]);return o.useEffect(()=>()=>h(),[h]),o.useEffect(()=>{if(l&&d){const j=N=>g(N,d),w=N=>g(N,l);return l.addEventListener("pointerleave",j),d.addEventListener("pointerleave",w),()=>{l.removeEventListener("pointerleave",j),d.removeEventListener("pointerleave",w)}}},[l,d,g,h]),o.useEffect(()=>{if(u){const j=w=>{const N=w.target,v={x:w.clientX,y:w.clientY},C=l?.contains(N)||d?.contains(N),E=!cr(v,u);C?h():E&&(h(),m())};return document.addEventListener("pointermove",j),()=>document.removeEventListener("pointermove",j)}},[l,d,u,m,h]),e.jsx(gt,{...t,ref:i})}),[ar,rr]=ye(ae,{isInside:!1}),nr=Bt("TooltipContent"),gt=o.forwardRef((t,a)=>{const{__scopeTooltip:r,children:s,"aria-label":n,onEscapeKeyDown:i,onPointerDownOutside:u,...f}=t,l=ne(J,r),m=be(r),{onClose:d}=l;return o.useEffect(()=>(document.addEventListener(Ae,d),()=>document.removeEventListener(Ae,d)),[d]),o.useEffect(()=>{if(l.trigger){const x=h=>{h.target?.contains(l.trigger)&&d()};return window.addEventListener("scroll",x,{capture:!0}),()=>window.removeEventListener("scroll",x,{capture:!0})}},[l.trigger,d]),e.jsx(zt,{asChild:!0,disableOutsidePointerEvents:!1,onEscapeKeyDown:i,onPointerDownOutside:u,onFocusOutside:x=>x.preventDefault(),onDismiss:d,children:e.jsxs(ea,{"data-state":l.stateAttribute,...m,...f,ref:a,style:{...f.style,"--radix-tooltip-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-tooltip-content-available-width":"var(--radix-popper-available-width)","--radix-tooltip-content-available-height":"var(--radix-popper-available-height)","--radix-tooltip-trigger-width":"var(--radix-popper-anchor-width)","--radix-tooltip-trigger-height":"var(--radix-popper-anchor-height)"},children:[e.jsx(nr,{children:s}),e.jsx(ar,{scope:r,isInside:!0,children:e.jsx(Kt,{id:l.contentId,role:"tooltip",children:n||s})})]})})});xt.displayName=J;var ft="TooltipArrow",yt=o.forwardRef((t,a)=>{const{__scopeTooltip:r,...s}=t,n=be(r);return rr(ft,r).isInside?null:e.jsx(Zt,{...n,...s,ref:a})});yt.displayName=ft;function sr(t,a){const r=Math.abs(a.top-t.y),s=Math.abs(a.bottom-t.y),n=Math.abs(a.right-t.x),i=Math.abs(a.left-t.x);switch(Math.min(r,s,n,i)){case i:return"left";case n:return"right";case r:return"top";case s:return"bottom";default:throw new Error("unreachable")}}function or(t,a,r=5){const s=[];switch(a){case"top":s.push({x:t.x-r,y:t.y+r},{x:t.x+r,y:t.y+r});break;case"bottom":s.push({x:t.x-r,y:t.y-r},{x:t.x+r,y:t.y-r});break;case"left":s.push({x:t.x+r,y:t.y-r},{x:t.x+r,y:t.y+r});break;case"right":s.push({x:t.x-r,y:t.y-r},{x:t.x-r,y:t.y+r});break}return s}function ir(t){const{top:a,right:r,bottom:s,left:n}=t;return[{x:n,y:a},{x:r,y:a},{x:r,y:s},{x:n,y:s}]}function cr(t,a){const{x:r,y:s}=t;let n=!1;for(let i=0,u=a.length-1;i<a.length;u=i++){const f=a[i],l=a[u],m=f.x,d=f.y,x=l.x,h=l.y;d>s!=h>s&&r<(x-m)*(s-d)/(h-d)+m&&(n=!n)}return n}function lr(t){const a=t.slice();return a.sort((r,s)=>r.x<s.x?-1:r.x>s.x?1:r.y<s.y?-1:r.y>s.y?1:0),dr(a)}function dr(t){if(t.length<=1)return t.slice();const a=[];for(let s=0;s<t.length;s++){const n=t[s];for(;a.length>=2;){const i=a[a.length-1],u=a[a.length-2];if((i.x-u.x)*(n.y-u.y)>=(i.y-u.y)*(n.x-u.x))a.pop();else break}a.push(n)}a.pop();const r=[];for(let s=t.length-1;s>=0;s--){const n=t[s];for(;r.length>=2;){const i=r[r.length-1],u=r[r.length-2];if((i.x-u.x)*(n.y-u.y)>=(i.y-u.y)*(n.x-u.x))r.pop();else break}r.push(n)}return r.pop(),a.length===1&&r.length===1&&a[0].x===r[0].x&&a[0].y===r[0].y?a:a.concat(r)}var ur=ut,pr=pt,mr=mt,hr=ht,xr=xt,gr=yt;function Re({delayDuration:t=0,...a}){return e.jsx(ur,{"data-slot":"tooltip-provider",delayDuration:t,...a})}function de({...t}){return e.jsx(Re,{children:e.jsx(pr,{"data-slot":"tooltip",...t})})}function ue({...t}){return e.jsx(mr,{"data-slot":"tooltip-trigger",...t})}function pe({className:t,sideOffset:a=0,children:r,...s}){return e.jsx(hr,{children:e.jsxs(xr,{"data-slot":"tooltip-content",sideOffset:a,className:Q("bg-foreground text-background animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 w-fit origin-(--radix-tooltip-content-transform-origin) rounded-md px-3 py-1.5 text-xs text-balance",t),...s,children:[r,e.jsx(gr,{className:"bg-foreground fill-foreground z-50 size-2.5 translate-y-[calc(-50%_-_2px)] rotate-45 rounded-[2px]"})]})})}function fr({articles:t,articlesAmount:a,setEditingArticle:r,handleDeleteArticle:s}){return!t||t.length===0?e.jsx(X,{className:"border-dashed",children:e.jsxs(M,{className:"flex flex-col items-center justify-center py-12",children:[e.jsx("div",{className:"rounded-lg bg-muted p-3 mb-4",children:e.jsx(Ie,{className:"h-8 w-8 text-muted-foreground"})}),e.jsx("h3",{className:"text-sm font-semibold mb-1",children:"No articles available"}),e.jsx("p",{className:"text-sm text-muted-foreground text-center max-w-xs",children:"Start creating articles to populate this list"})]})}):e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold tracking-tight",children:"Articles"}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Manage your published articles (",a,")"]})]})}),e.jsx("ul",{className:"grid gap-4 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4",children:t.map(n=>e.jsx("li",{className:"group",children:e.jsxs(X,{className:"h-full overflow-hidden flex flex-col transition-all duration-200 hover:shadow-lg hover:border-primary/50",children:[e.jsxs("div",{className:"relative w-full h-48 bg-muted overflow-hidden flex-shrink-0",children:[n.banner?e.jsx("img",{src:`${Le}${n.banner}`,alt:n.title,className:"w-full h-full object-cover group-hover:scale-110 transition-transform duration-300"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center bg-gradient-to-br from-muted via-muted to-muted-foreground/20",children:e.jsx(Ie,{className:"h-12 w-12 text-muted-foreground/30"})}),e.jsx("div",{className:"absolute inset-0 bg-black/0 group-hover:bg-black/10 transition-colors"}),e.jsxs("div",{className:"absolute top-2 right-2 flex gap-2",children:[n.featured&&e.jsx(Re,{children:e.jsxs(de,{children:[e.jsx(ue,{asChild:!0,children:e.jsxs(Y,{className:"bg-yellow-500 hover:bg-yellow-600 text-black",children:[e.jsx(ya,{className:"h-3 w-3 mr-1"}),"Featured"]})}),e.jsx(pe,{children:"This article is featured"})]})}),e.jsxs(Y,{className:"bg-black/60 hover:bg-black/80 backdrop-blur-sm",children:["#",n.id]})]})]}),e.jsxs(Me,{className:"pb-2",children:[e.jsx(De,{className:"text-sm font-semibold line-clamp-2 group-hover:text-primary transition-colors duration-200",children:n.title}),n.createdAt&&e.jsxs($e,{className:"flex items-center gap-1 text-xs mt-1",children:[e.jsx(sa,{className:"h-3 w-3"}),new Date(n.createdAt).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})]})]}),e.jsxs(M,{className:"pb-3 flex-1 space-y-3",children:[e.jsx("p",{className:"text-xs text-muted-foreground line-clamp-3 leading-relaxed",children:n.content?.substring(0,120)||"No content available"}),e.jsx("div",{className:"space-y-2",children:n.categories&&n.categories.length>0?e.jsxs("div",{className:"flex flex-wrap gap-1",children:[n.categories.slice(0,3).map(i=>e.jsx(Y,{variant:"secondary",className:"text-xs font-medium",children:i.name},i.id)),n.categories.length>3&&e.jsxs(Y,{variant:"outline",className:"text-xs",children:["+",n.categories.length-3]})]}):e.jsx("div",{className:"inline-flex",children:e.jsx(Y,{variant:"outline",className:"text-xs opacity-50",children:"No categories"})})}),e.jsxs("div",{className:"flex items-center gap-2 pt-2 border-t border-border",children:[e.jsx(Ut,{className:"h-3 w-3 text-muted-foreground"}),e.jsx("span",{className:"text-xs text-muted-foreground",children:"Author ID:"}),e.jsx(Y,{variant:"outline",className:"text-xs font-mono",children:n.authorId})]})]}),e.jsx(Vt,{className:"gap-2 pt-3 border-t border-border bg-muted/30",children:e.jsxs(Re,{children:[e.jsxs(de,{children:[e.jsx(ue,{asChild:!0,children:e.jsxs(I,{onClick:()=>r(n),className:"flex-1 gap-1.5 cursor-pointer",variant:"default",size:"sm",children:[e.jsx(Ze,{className:"h-3.5 w-3.5"}),e.jsx("span",{className:"hidden sm:inline",children:"Edit"})]})}),e.jsx(pe,{children:"Edit this article"})]}),e.jsxs(de,{children:[e.jsx(ue,{asChild:!0,children:e.jsx(I,{asChild:!0,variant:"outline",size:"sm",className:"flex-1 gap-1.5",children:e.jsxs(Ht,{to:`/article/${n.id}`,children:[e.jsx(Qe,{className:"h-3.5 w-3.5"}),e.jsx("span",{className:"hidden sm:inline",children:"View"})]})})}),e.jsx(pe,{children:"View article on site"})]}),e.jsxs(de,{children:[e.jsx(ue,{asChild:!0,children:e.jsxs(I,{onClick:()=>s(n.id),className:"flex-1 gap-1.5 cursor-pointer",variant:"destructive",size:"sm",children:[e.jsx(et,{className:"h-3.5 w-3.5"}),e.jsx("span",{className:"hidden sm:inline",children:"Delete"})]})}),e.jsx(pe,{children:"Delete this article"})]})]})})]})},n.id))})]})}function Ir(){const{token:t,isAuthenticated:a}=he(),{articles:r,loading:s,error:n,fetchArticles:i,createNewArticle:u,updateExistingArticle:f,deleteArticle:l}=qt(),{tempId:m,tempIdToken:d,loading:x,error:h,fetchTempId:g}=Ia(),{uploadNewImage:j,loading:w,error:N}=ka(),{categories:v,loading:C,addCategory:E,removeCategory:T,updateCategoryData:_}=Ma(),[b,P]=o.useState({title:"",content:"",tempId:"",banner:null,featured:!1}),[F,se]=o.useState(null),[Z,H]=o.useState({name:"",description:""}),[q,G]=o.useState([]),[oe,O]=o.useState(0),[K,y]=o.useState(8),[D,R]=o.useState(1),S=Math.ceil(r.length/K),ie=r.sort((c,p)=>new Date(p.createdAt)-new Date(c.createdAt)).slice(oe,oe+K),[ce,Be]=o.useState(0),[le,yr]=o.useState(3),[Ue,He]=o.useState(1),ee=Math.ceil(v.length/le);console.log("categoriesTotalPages:",ee);const bt=v.sort((c,p)=>c.name.localeCompare(p.name)).slice(ce,ce+le),V=o.useRef(null),je=o.useRef(null);o.useEffect(()=>{const c=setInterval(()=>{a&&t&&(k.info("Your session has expired. Please log in again."),window.location.reload())},6e5);return()=>clearInterval(c)},[]),o.useEffect(()=>{m?P(c=>({...c,tempId:m})):g?.()},[m]),o.useEffect(()=>{Ue>ee&&(He(c=>c>1?c-1:1),Be(c=>c>0?c-le:0)),D>S&&(R(c=>c>1?c-1:1),O(c=>c>0?c-K:0))},[ee,S]);const vt=c=>{R(c),O((c-1)*K)},jt=c=>{He(c),Be((c-1)*le)},Ct=c=>{const{name:p,value:L,files:z}=c.target;P(p==="banner"?Te=>({...Te,banner:z?.[0]??null}):Te=>({...Te,[p]:L}))},Nt=()=>{Ne(!1),ke(null),P({title:"",content:"",tempId:m||"",banner:null,featured:!1}),G([]),V.current&&(V.current.value=""),k.info("Article editing cancelled")},wt=c=>{const{files:p}=c.target;p&&p[0]&&se(p[0])},kt=c=>{if(!c){k.info("Category editing cancelled"),we(!1),H({id:null,name:"",description:""});return}k.info(`Category "${c.name}" loaded for editing (ID: ${c.id})`),we(!0),H({id:c.id,name:c.name,description:c.description})},Tt=c=>{const{name:p,value:L}=c.target;H(z=>({...z,[p]:L}))},Pt=async c=>{c.preventDefault();try{const p=await E(Z);H({name:"",description:""}),k.success("Categoría creada")}catch{k.error("Error creando categoría")}},Et=async c=>{c.preventDefault();try{await _(Z),H({name:"",description:"",id:null}),we(!1),k.success("Category updated")}catch(p){k.error("Error updating category"),console.error(p)}},It=async c=>{if(window.confirm("¿Eliminar esta categoría?"))try{await T(c),k.success("Categoría eliminada")}catch{k.error("Error eliminando categoría")}},At=c=>{const p=Number(c.target.value);G(L=>c.target.checked?[...L,p]:L.filter(z=>z!==p))},_t=async c=>{c.preventDefault();try{const p=new FormData;p.append("title",b.title),p.append("content",b.content),p.append("tempId",b.tempId),p.append("featured",b.featured?"true":"false"),b.banner&&p.append("banner",b.banner),p.append("categoryIds",JSON.stringify(q)),console.log("Submitting article with data:",{title:b.title,content:b.content,tempId:b.tempId,featured:b.featured,banner:b.banner,categoryIds:q}),await u(p,d),k.success("Article created successfully"),P({title:"",content:"",tempId:m||"",banner:null,featured:!1}),G([]),V.current&&(V.current.value=""),i?.()}catch(p){console.error("Error creating article:",p),k.error("Error creating article")}},Rt=async c=>{if(c.preventDefault(),!!F)try{const p=new FormData;p.append("image",F),p.append("tempId",m),Ce&&p.append("articleId",te);const L=await j(p,d);k.success("Image uploaded successfully"),se(null),je.current&&(je.current.value=""),P(z=>({...z,content:z.content+`
![alt text](${Le}${L.url})`}))}catch(p){console.error("Error uploading image:",p),k.error("Error uploading image")}},St=c=>{k.info("Article has been loaded to the form for editing"),ke(c.id),console.log("Editing article:",c),P({title:c.title,content:c.content,tempId:c.tempId||"",banner:c.banner||null,featured:c.featured}),G(c.categories.map(p=>p.id)),Ne(!0)},Lt=async c=>{if(window.confirm("Are you sure you want to delete this article?"))try{await l(c),i?.()}catch(p){console.error("Error deleting article:",p),k.error("Error deleting article")}},qe=async c=>{if(c.preventDefault(),!te){k.error("No article selected for editing");return}const p=new FormData;p.append("title",b.title),p.append("content",b.content),p.append("tempId",b.tempId),p.append("featured",b.featured?"true":"false"),p.append("articleId",te),console.log("featured value:",b.featured),console.log("featured is boolean:",typeof b.featured=="boolean"),b.banner instanceof File?p.append("banner",b.banner):b.banner&&typeof b.banner=="string"&&p.append("existingBanner",b.banner),p.append("categoryIds",JSON.stringify(q));try{console.log("Editing article with data:",{title:b.title,content:b.content,tempId:b.tempId,featured:b.featured,banner:b.banner,articleId:te,categoryIds:q}),await f(te,p,d),k.success("Article updated successfully"),P({title:"",content:"",tempId:m||"",banner:null,featured:!1}),ke(null),G([]),Ne(!1),V.current&&(V.current.value=""),i?.()}catch(L){console.error("Error updating article:",L),k.error("Error updating article")}},[Ce,Ne]=o.useState(!1),[Mt,we]=o.useState(!1),[te,ke]=o.useState(null),Ge=s||x,Dt=w||x;return e.jsx("div",{className:"p-4 space-y-6 max-w-7xl mx-auto",children:e.jsxs(ta,{cascade:!0,damping:.05,triggerOnce:!0,duration:400,children:[e.jsx(za,{tempIdError:h,articleError:n,imageError:N}),e.jsx(Ka,{formData:b,onChange:Ct,bannerInputRef:V,imageInputRef:je,handleImageChange:wt,handleImageUpload:Rt,imageData:F,isUploadingImage:Dt,handleSubmit:_t,isSubmittingArticle:Ge,categories:v,selectedCategories:q,handleCategoryCheckbox:At,isEditing:Ce,cancelEditArticle:Nt,handleSubmitEdit:qe}),e.jsx(Pe,{}),e.jsx(Xa,{categoryForm:Z,onCategoryFormChange:Tt,onCategorySubmit:Pt,onEditCategory:kt,categories:bt,categoryAmount:v.length,categoriesLoading:C,onDeleteCategory:It,isEditingCategory:Mt,onEditCategorySubmit:Et}),ee>1&&e.jsx(Ee,{currentPage:Ue,totalPages:ee,onPageChange:jt}),e.jsx(Pe,{}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h3",{className:"text-lg font-bold",children:"Existing Articles"}),e.jsx(fr,{articles:ie,articlesAmount:r.length,setEditingArticle:St,handleSubmitEdit:qe,isSubmittingArticle:Ge,isEditing:Ce,handleDeleteArticle:Lt})]}),S>1&&e.jsx(Ee,{currentPage:D,totalPages:S,onPageChange:vt})]})})}export{Ir as default};
