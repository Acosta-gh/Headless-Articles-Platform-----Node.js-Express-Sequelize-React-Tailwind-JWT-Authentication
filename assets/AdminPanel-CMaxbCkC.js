import{c as M,w as W,r as o,t as me,j as e,n as re,x as Dt,a as Ye,y as Se,P as he,u as Ke,d as xe,e as z,q as I,I as pe,z as Xe,B as Le,A as Pe,b as $t,g as Ft,D as Ot,C as Bt,U as zt,L as Ut,o as Ht,E as k}from"./index-4Xp8Ba2F.js";import{P as Ee}from"./PaginationControls-ESlcZwPL.js";import{L as qt,T as Je}from"./textarea-DX82jOto.js";import{L as $,E as We}from"./label-B6Sb77Vz.js";import{C as X,a as Me,b as De,c as $e,d as L,e as Gt}from"./card-C86A7I4G.js";import{B as Y}from"./badge-DDms8UDH.js";import{u as Vt,R as Yt}from"./index-imd0huTv.js";import{u as Kt,b as Xt,c as Qe,R as Jt,A as Wt,a as Qt,C as Zt}from"./index-C_4dJ8RL.js";import{F as er}from"./index-BPGcWi37.js";import"./ellipsis-Df_YqgoH.js";/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tr=[["path",{d:"M6 12h9a4 4 0 0 1 0 8H7a1 1 0 0 1-1-1V5a1 1 0 0 1 1-1h7a4 4 0 0 1 0 8",key:"mg9rjx"}]],rr=M("bold",tr);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ar=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],sr=M("calendar",ar);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nr=[["path",{d:"m16 18 6-6-6-6",key:"eg8j8"}],["path",{d:"m8 6-6 6 6 6",key:"ppft3o"}]],or=M("code",nr);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ir=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]],Ie=M("image",ir);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cr=[["line",{x1:"19",x2:"10",y1:"4",y2:"4",key:"15jd3p"}],["line",{x1:"14",x2:"5",y1:"20",y2:"20",key:"bu0au3"}],["line",{x1:"15",x2:"9",y1:"4",y2:"20",key:"uljnxc"}]],lr=M("italic",cr);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dr=[["path",{d:"M3 5h.01",key:"18ugdj"}],["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 19h.01",key:"noohij"}],["path",{d:"M8 5h13",key:"1pao27"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 19h13",key:"m83p4d"}]],ur=M("list",dr);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pr=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],Ze=M("pen",pr);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mr=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],hr=M("plus",mr);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xr=[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]],gr=M("star",xr);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fr=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],et=M("trash-2",fr);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const br=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],yr=M("upload",br);let vr="https://blog.api.auroralabs.com.ar/api/v1/";const jr=vr+"image/",Cr=async(t,r,a)=>{console.log("Uploading image with tempIdToken:",r);const n=await W.post(jr,t,{headers:{"x-tempid-token":r,Authorization:`Bearer ${a}`}});return console.log("Upload response:",n.data),n.data},Nr=()=>{const[t,r]=o.useState(null),[a,n]=o.useState(!1),[s,i]=o.useState(null),{token:u}=me(),f=o.useCallback(async(l,m)=>{n(!0);try{const d=await Cr(l,m,u);return r(d),d}catch(d){throw i(d),d}finally{n(!1)}},[]);return{imageUrl:t,loading:a,error:s,uploadNewImage:f}};let wr="https://blog.api.auroralabs.com.ar/api/v1/";const kr=wr+"tempid/",Tr=async t=>(await W.get(kr,{headers:{Authorization:`Bearer ${t}`}})).data,Pr=()=>{const[t,r]=o.useState(null),[a,n]=o.useState(null),[s,i]=o.useState(!1),[u,f]=o.useState(null),{token:l}=me(),m=o.useCallback(async()=>{i(!0);try{const d=await Tr(l);r(d.tempId),n(d.token)}catch(d){f(d)}finally{i(!1)}},[l]);return o.useEffect(()=>{l?m():console.warn("No admin token available to fetch temp ID.")},[m,l]),{tempId:t,tempIdToken:a,loading:s,error:u,fetchTempId:m}},Er="https://blog.api.auroralabs.com.ar/api/v1/",ge=Er+"category",Ir=async()=>(await W.get(ge)).data,Ar=async(t,r)=>(await W.post(ge,t,{headers:{Authorization:`Bearer ${r}`}})).data,_r=async(t,r)=>(await W.put(`${ge}/${t.id}`,t,{headers:{Authorization:`Bearer ${r}`}})).data,Rr=async(t,r)=>{await W.delete(`${ge}/${t}`,{headers:{Authorization:`Bearer ${r}`}})},Sr=()=>{const[t,r]=o.useState([]),[a,n]=o.useState(!1),[s,i]=o.useState(null),{token:u}=me(),f=async()=>{n(!0);try{const x=await Ir();r(x)}catch(x){i(x)}finally{n(!1)}},l=async x=>{n(!0);try{const h=await Ar(x,u);return r(g=>[...g,h]),h}catch(h){throw i(h),h}finally{n(!1)}},m=async x=>{n(!0);try{await Rr(x,u),r(h=>h.filter(g=>g.id!==x))}catch(h){throw i(h),h}finally{n(!1)}},d=async x=>{n(!0);try{const h=await _r(x,u);return r(g=>g.map(j=>j.id===h.id?h:j)),h}catch(h){throw i(h),h}finally{n(!1)}};return o.useEffect(()=>{f()},[]),{categories:t,loading:a,error:s,fetchCategories:f,addCategory:l,removeCategory:m,updateCategoryData:d}},Lr=Dt("relative w-full rounded-lg border px-4 py-3 text-sm grid has-[>svg]:grid-cols-[calc(var(--spacing)*4)_1fr] grid-cols-[0_1fr] has-[>svg]:gap-x-3 gap-y-0.5 items-start [&>svg]:size-4 [&>svg]:translate-y-0.5 [&>svg]:text-current",{variants:{variant:{default:"bg-card text-card-foreground",destructive:"text-destructive bg-card [&>svg]:text-current *:data-[slot=alert-description]:text-destructive/90"}},defaultVariants:{variant:"default"}});function Mr({className:t,variant:r,...a}){return e.jsx("div",{"data-slot":"alert",role:"alert",className:re(Lr({variant:r}),t),...a})}function Dr({className:t,...r}){return e.jsx("div",{"data-slot":"alert-title",className:re("col-start-2 line-clamp-1 min-h-4 font-medium tracking-tight",t),...r})}function $r({className:t,...r}){return e.jsx("div",{"data-slot":"alert-description",className:re("text-muted-foreground col-start-2 grid justify-items-start gap-1 text-sm [&_p]:leading-relaxed",t),...r})}function Fr({tempIdError:t,articleError:r,imageError:a}){return!t&&!r&&!a?null:e.jsxs(Mr,{variant:"destructive",children:[e.jsx(Dr,{children:"Error"}),e.jsxs($r,{children:[t&&e.jsxs("div",{children:["TempID: ",t.message]}),r&&e.jsxs("div",{children:["Artículo: ",r.message]}),a&&e.jsxs("div",{children:["Imagen: ",a.message]})]})]})}var fe="Checkbox",[Or]=Ye(fe),[Br,Fe]=Or(fe);function zr(t){const{__scopeCheckbox:r,checked:a,children:n,defaultChecked:s,disabled:i,form:u,name:f,onCheckedChange:l,required:m,value:d="on",internal_do_not_use_render:x}=t,[h,g]=Ke({prop:a,defaultProp:s??!1,onChange:l,caller:fe}),[j,w]=o.useState(null),[N,v]=o.useState(null),C=o.useRef(!1),E=j?!!u||!!j.closest("form"):!0,T={checked:h,disabled:i,setChecked:g,control:j,setControl:w,name:f,form:u,value:d,hasConsumerStoppedPropagationRef:C,required:m,defaultChecked:U(s)?!1:s,isFormControl:E,bubbleInput:N,setBubbleInput:v};return e.jsx(Br,{scope:r,...T,children:Ur(x)?x(T):n})}var tt="CheckboxTrigger",rt=o.forwardRef(({__scopeCheckbox:t,onKeyDown:r,onClick:a,...n},s)=>{const{control:i,value:u,disabled:f,checked:l,required:m,setControl:d,setChecked:x,hasConsumerStoppedPropagationRef:h,isFormControl:g,bubbleInput:j}=Fe(tt,t),w=xe(s,d),N=o.useRef(l);return o.useEffect(()=>{const v=i?.form;if(v){const C=()=>x(N.current);return v.addEventListener("reset",C),()=>v.removeEventListener("reset",C)}},[i,x]),e.jsx(he.button,{type:"button",role:"checkbox","aria-checked":U(l)?"mixed":l,"aria-required":m,"data-state":ct(l),"data-disabled":f?"":void 0,disabled:f,value:u,...n,ref:w,onKeyDown:z(r,v=>{v.key==="Enter"&&v.preventDefault()}),onClick:z(a,v=>{x(C=>U(C)?!0:!C),j&&g&&(h.current=v.isPropagationStopped(),h.current||v.stopPropagation())})})});rt.displayName=tt;var at=o.forwardRef((t,r)=>{const{__scopeCheckbox:a,name:n,checked:s,defaultChecked:i,required:u,disabled:f,value:l,onCheckedChange:m,form:d,...x}=t;return e.jsx(zr,{__scopeCheckbox:a,checked:s,defaultChecked:i,disabled:f,required:u,onCheckedChange:m,name:n,form:d,value:l,internal_do_not_use_render:({isFormControl:h})=>e.jsxs(e.Fragment,{children:[e.jsx(rt,{...x,ref:r,__scopeCheckbox:a}),h&&e.jsx(it,{__scopeCheckbox:a})]})})});at.displayName=fe;var st="CheckboxIndicator",nt=o.forwardRef((t,r)=>{const{__scopeCheckbox:a,forceMount:n,...s}=t,i=Fe(st,a);return e.jsx(Se,{present:n||U(i.checked)||i.checked===!0,children:e.jsx(he.span,{"data-state":ct(i.checked),"data-disabled":i.disabled?"":void 0,...s,ref:r,style:{pointerEvents:"none",...t.style}})})});nt.displayName=st;var ot="CheckboxBubbleInput",it=o.forwardRef(({__scopeCheckbox:t,...r},a)=>{const{control:n,hasConsumerStoppedPropagationRef:s,checked:i,defaultChecked:u,required:f,disabled:l,name:m,value:d,form:x,bubbleInput:h,setBubbleInput:g}=Fe(ot,t),j=xe(a,g),w=Vt(i),N=Kt(n);o.useEffect(()=>{const C=h;if(!C)return;const E=window.HTMLInputElement.prototype,A=Object.getOwnPropertyDescriptor(E,"checked").set,y=!s.current;if(w!==i&&A){const P=new Event("click",{bubbles:y});C.indeterminate=U(i),A.call(C,U(i)?!1:i),C.dispatchEvent(P)}},[h,w,i,s]);const v=o.useRef(U(i)?!1:i);return e.jsx(he.input,{type:"checkbox","aria-hidden":!0,defaultChecked:u??v.current,required:f,disabled:l,name:m,value:d,form:x,...r,tabIndex:-1,ref:j,style:{...r.style,...N,position:"absolute",pointerEvents:"none",opacity:0,margin:0,transform:"translateX(-100%)"}})});it.displayName=ot;function Ur(t){return typeof t=="function"}function U(t){return t==="indeterminate"}function ct(t){return U(t)?"indeterminate":t?"checked":"unchecked"}function Ve({className:t,...r}){return e.jsx(at,{"data-slot":"checkbox",className:re("peer border-input dark:bg-input/30 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground dark:data-[state=checked]:bg-primary data-[state=checked]:border-primary focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive size-4 shrink-0 rounded-[4px] border shadow-xs transition-shadow outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50",t),...r,children:e.jsx(nt,{"data-slot":"checkbox-indicator",className:"grid place-content-center text-current transition-none",children:e.jsx(Xt,{className:"size-3.5"})})})}function Hr({imageInputRef:t,onImageChange:r,onUpload:a,imageData:n,isUploadingImage:s}){return e.jsx("div",{className:"space-y-2 flex align-items-center gap-4",children:e.jsxs("div",{className:"flex gap-2 items-center ",children:[e.jsxs(I,{type:"button",size:"sm",variant:"outline",className:"gap-2 px-3",children:[e.jsx(pe,{ref:t,id:"image",type:"file",name:"image",accept:"image/*",onChange:r,className:"hidden"}),e.jsxs("label",{htmlFor:"image",type:"button",className:"flex flex-row gap-2 align-items-center items-center",children:[e.jsx(Ie,{className:"h-4 w-4"}),e.jsx("span",{className:"text-sm text-muted-foreground ",children:n?"Change":"Upload Image"})]})]}),e.jsxs(I,{type:"button",disabled:s||!n,onClick:a,variant:"outline",size:"sm",className:"gap-2",children:[s?e.jsx(Xe,{className:"h-4 w-4 animate-spin"}):e.jsx(yr,{className:"h-4 w-4"}),e.jsx("span",{className:"hidden sm:inline",children:s?"Uploading...":"Confirm Upload"})]})]})})}function qr({formData:t,onChange:r,bannerInputRef:a,imageInputRef:n,handleImageChange:s,handleImageUpload:i,imageData:u,isUploadingImage:f,handleSubmit:l,isSubmittingArticle:m,categories:d,selectedCategories:x,handleCategoryCheckbox:h,isEditing:g,cancelEditArticle:j,handleSubmitEdit:w}){const[N,v]=o.useState(null),[C,E]=o.useState(0),[T,A]=o.useState(12),[y,P]=o.useState(1),F=Math.ceil(d.length/T),se=d.slice(C,C+T),Q=b=>{P(b);const D=(b-1)*T;E(D)},H=b=>{b.preventDefault(),l(b),v(null)},q=b=>{b.preventDefault(),w(b),v(null)},G=()=>{j(),v(null)},ne=b=>{const D=b.target.files?.[0];if(D){const _=new FileReader;_.onload=R=>{v(R.target?.result)},_.readAsDataURL(D)}r(b)},O=(b,D="")=>{const _=document.getElementById("content"),R=_.selectionStart,ve=_.selectionEnd,oe=t.content.substring(R,ve),ie=t.content.substring(0,R)+b+oe+D+t.content.substring(ve);r({target:{name:"content",value:ie}}),setTimeout(()=>{_.focus(),_.selectionStart=R+b.length,_.selectionEnd=R+b.length+oe.length},0)},K=[{icon:rr,label:"Bold",onClick:()=>O("**","**")},{icon:lr,label:"Cursive",onClick:()=>O("*","*")},{icon:or,label:"Code",onClick:()=>O("`","`")},{icon:qt,label:"Link",onClick:()=>O("[texto](",")")},{icon:ur,label:"List",onClick:()=>O(`
- `,"")}];return o.useEffect(()=>{g&&t.banner&&v(typeof t.banner=="string"?`${Le}${t.banner}`:null)},[g,t.banner]),o.useEffect(()=>{y>F&&(P(b=>b>1?b-1:1),E(b=>b>T?b-T:0))},[F]),e.jsx("div",{className:"w-full mx-auto",children:e.jsx("form",{onSubmit:g?q:H,className:"space-y-6",children:e.jsxs(X,{className:"border-l-4 border-l-primary",children:[e.jsxs(Me,{children:[e.jsx(De,{className:"text-2xl",children:g?"Edit article":"Create new article"}),e.jsx($e,{children:g?"Update the content and settings of your article":"Fill in the details to publish a new article"})]}),e.jsx(L,{className:"space-y-4",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx($,{htmlFor:"title",className:"text-sm font-medium",children:"Title"}),e.jsx(pe,{id:"title",type:"text",name:"title",placeholder:"E.g., The Future of Technology in Everyday Life",value:t.title,onChange:r,required:!0,className:"text-base"})]})}),e.jsxs(L,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx($,{htmlFor:"banner",className:"text-sm font-medium",children:"Banner Image"}),e.jsx("div",{className:"relative",children:e.jsx(pe,{ref:a,id:"banner",type:"file",name:"banner",accept:"image/*",onChange:ne,className:"cursor-pointer"})})]}),N&&e.jsxs("div",{className:"relative w-full h-64 rounded-lg border-2 border-primary/20 overflow-hidden bg-muted",children:[e.jsx("img",{src:N,alt:"Banner preview",className:"w-full h-full object-cover"}),e.jsx("div",{className:"absolute top-2 right-2",children:e.jsxs(Y,{variant:"secondary",className:"flex items-center gap-1",children:[e.jsx(We,{className:"h-3 w-3"}),"Preview"]})})]})]}),e.jsxs(L,{className:"space-y-3",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx($,{className:"text-xs font-semibold text-muted-foreground",children:"Markdown Tools"}),e.jsxs("div",{className:"flex flex-wrap gap-1 p-3 bg-muted border border-input rounded-lg",children:[K.map(b=>e.jsx(I,{type:"button",variant:"outline",size:"sm",onClick:b.onClick,title:b.label,className:"h-9 w-9 p-0 hover:bg-primary hover:text-primary-foreground transition-colors",children:e.jsx(b.icon,{className:"h-4 w-4"})},b.label)),e.jsx(Pe,{orientation:"vertical",className:"mx-1"}),e.jsx(Hr,{imageInputRef:n,onImageChange:s,onUpload:i,imageData:u,isUploadingImage:f})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx($,{htmlFor:"content",className:"text-sm font-medium",children:"Article Content"}),e.jsx(Je,{id:"content",name:"content",placeholder:"Write your article here... You can use Markdown to format.",value:t.content,onChange:r,required:!0,className:"min-h-64 font-mono text-sm resize-vertical"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"You can use Markdown syntax to format your content."})]})]}),e.jsxs(L,{children:[e.jsx("div",{className:"space-y-2 mb-3",children:e.jsx($,{className:"text-sm font-medium",children:"Tags/Categories"})}),d.length===0?e.jsx("p",{className:"text-sm text-muted-foreground",children:"No categories available. Please create categories first."}):e.jsx("div",{className:"flex flex-wrap gap-3",children:se.map(b=>e.jsxs("div",{className:"flex items-center space-x-2 p-2 rounded-lg border border-input hover:bg-accent transition-colors",children:[e.jsx(Ve,{id:`cat-${b.id}`,checked:x.includes(b.id),onCheckedChange:()=>h({target:{value:b.id,checked:!x.includes(b.id)}})}),e.jsx($,{htmlFor:`cat-${b.id}`,className:"cursor-pointer font-medium text-sm",children:b.name})]},b.id))}),F>1&&e.jsx(Ee,{currentPage:y,totalPages:F,onPageChange:Q})]}),e.jsx(L,{children:e.jsxs("div",{className:"flex items-center space-x-3 p-3 rounded-lg border border-input hover:bg-accent/50 transition-colors cursor-pointer",children:[e.jsx(Ve,{id:"featured",checked:t.featured,onCheckedChange:b=>r({target:{name:"featured",value:b}})}),e.jsxs("div",{className:"flex-1",children:[e.jsx($,{htmlFor:"featured",className:"cursor-pointer font-medium text-sm",children:"Mark as Featured Article"}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Featured articles are highlighted on the homepage and in"})]})]})}),e.jsx(L,{children:e.jsxs("div",{className:"flex gap-2 pt-4 ",children:[e.jsxs(I,{type:"submit",disabled:m,size:"lg",className:"flex-1 cursor-pointer",children:[m&&e.jsx(Xe,{className:"mr-2 h-4 w-4 animate-spin"}),g?"Update Article":"Create Article"]}),g&&e.jsx(I,{type:"submit",disabled:m,size:"lg",variant:"outline",className:"flex-1 cursor-pointer",onClick:G,children:"Cancel"})]})})]})})})}function Gr({categoryForm:t,onCategoryFormChange:r,onCategorySubmit:a,onEditCategory:n,categories:s,categoryAmount:i,categoriesLoading:u,onDeleteCategory:f,isEditingCategory:l,onEditCategorySubmit:m}){return e.jsxs("div",{className:"w-full mx-auto space-y-6",children:[e.jsxs(X,{className:"border-l-4 border-l-primary",children:[e.jsxs(Me,{children:[e.jsxs(De,{className:"flex items-center gap-2",children:[e.jsx(hr,{className:"w-5 h-5"}),l?"Edit Category":"New Category"]}),e.jsx($e,{children:l?"Update the details of your category":"Create a new category to organize your articles"})]}),e.jsx(L,{children:e.jsxs("form",{onSubmit:l?m:a,className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx($,{htmlFor:"cat-name",className:"text-sm font-medium",children:"Name"}),e.jsx(pe,{id:"cat-name",name:"name",placeholder:"E.g., Technology, Health, Lifestyle",value:t.name,onChange:r,required:!0,className:"transition-colors focus:ring-2"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx($,{htmlFor:"cat-desc",className:"text-sm font-medium",children:"Description"}),e.jsx(Je,{id:"cat-desc",name:"description",placeholder:"A brief description of the category",value:t.description,onChange:r,rows:3,className:"resize-none transition-colors focus:ring-2"})]}),e.jsxs("div",{className:"flex gap-2 pt-2",children:[e.jsx(I,{type:"submit",disabled:u,className:"flex-1",children:u?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-2 border-white border-t-transparent mr-2"}),l?"Updating...":"Creating..."]}):l?"Update Category":"Create Category"}),l&&e.jsx(I,{type:"button",variant:"outline",onClick:()=>n(null),children:"Cancel"})]})]})})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"px-1",children:[e.jsxs("h2",{className:"text-lg font-semibold tracking-tight",children:["Categories (",i,")"]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Manage your existing categories below."})]}),s.length===0?e.jsx(X,{className:"border-dashed",children:e.jsx(L,{className:"py-8 text-center",children:e.jsx("p",{className:"text-muted-foreground",children:"There are no categories yet. Create one to get started!"})})}):e.jsx("div",{className:"grid gap-2",children:s.map(d=>e.jsx(X,{className:"hover:shadow-md transition-all duration-200 group",children:e.jsx(L,{className:"py-4 px-4",children:e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"font-semibold text-sm truncate group-hover:text-primary transition-colors",children:d.name}),d.description&&e.jsx("p",{className:"text-xs text-muted-foreground mt-1 line-clamp-2",children:d.description})]}),e.jsxs("div",{className:"flex items-center gap-2 flex-shrink-0",children:[e.jsx(I,{onClick:()=>n(d),size:"sm",variant:"outline",className:"h-8 w-8 p-0 hover:bg-blue-50 hover:text-blue-600 hover:border-blue-300",children:e.jsx(Ze,{className:"h-4 w-4"})}),e.jsx(I,{size:"sm",variant:"destructive",onClick:()=>f(d.id),className:"h-8 w-8 p-0",children:e.jsx(et,{className:"h-4 w-4"})})]})]})})},d.id))})]})]})}var[be]=Ye("Tooltip",[Qe]),ye=Qe(),lt="TooltipProvider",Vr=700,Ae="tooltip.open",[Yr,Oe]=be(lt),dt=t=>{const{__scopeTooltip:r,delayDuration:a=Vr,skipDelayDuration:n=300,disableHoverableContent:s=!1,children:i}=t,u=o.useRef(!0),f=o.useRef(!1),l=o.useRef(0);return o.useEffect(()=>{const m=l.current;return()=>window.clearTimeout(m)},[]),e.jsx(Yr,{scope:r,isOpenDelayedRef:u,delayDuration:a,onOpen:o.useCallback(()=>{window.clearTimeout(l.current),u.current=!1},[]),onClose:o.useCallback(()=>{window.clearTimeout(l.current),l.current=window.setTimeout(()=>u.current=!0,n)},[n]),isPointerInTransitRef:f,onPointerInTransitChange:o.useCallback(m=>{f.current=m},[]),disableHoverableContent:s,children:i})};dt.displayName=lt;var te="Tooltip",[Kr,ae]=be(te),ut=t=>{const{__scopeTooltip:r,children:a,open:n,defaultOpen:s,onOpenChange:i,disableHoverableContent:u,delayDuration:f}=t,l=Oe(te,t.__scopeTooltip),m=ye(r),[d,x]=o.useState(null),h=$t(),g=o.useRef(0),j=u??l.disableHoverableContent,w=f??l.delayDuration,N=o.useRef(!1),[v,C]=Ke({prop:n,defaultProp:s??!1,onChange:P=>{P?(l.onOpen(),document.dispatchEvent(new CustomEvent(Ae))):l.onClose(),i?.(P)},caller:te}),E=o.useMemo(()=>v?N.current?"delayed-open":"instant-open":"closed",[v]),T=o.useCallback(()=>{window.clearTimeout(g.current),g.current=0,N.current=!1,C(!0)},[C]),A=o.useCallback(()=>{window.clearTimeout(g.current),g.current=0,C(!1)},[C]),y=o.useCallback(()=>{window.clearTimeout(g.current),g.current=window.setTimeout(()=>{N.current=!0,C(!0),g.current=0},w)},[w,C]);return o.useEffect(()=>()=>{g.current&&(window.clearTimeout(g.current),g.current=0)},[]),e.jsx(Jt,{...m,children:e.jsx(Kr,{scope:r,contentId:h,open:v,stateAttribute:E,trigger:d,onTriggerChange:x,onTriggerEnter:o.useCallback(()=>{l.isOpenDelayedRef.current?y():T()},[l.isOpenDelayedRef,y,T]),onTriggerLeave:o.useCallback(()=>{j?A():(window.clearTimeout(g.current),g.current=0)},[A,j]),onOpen:T,onClose:A,disableHoverableContent:j,children:a})})};ut.displayName=te;var _e="TooltipTrigger",pt=o.forwardRef((t,r)=>{const{__scopeTooltip:a,...n}=t,s=ae(_e,a),i=Oe(_e,a),u=ye(a),f=o.useRef(null),l=xe(r,f,s.onTriggerChange),m=o.useRef(!1),d=o.useRef(!1),x=o.useCallback(()=>m.current=!1,[]);return o.useEffect(()=>()=>document.removeEventListener("pointerup",x),[x]),e.jsx(Wt,{asChild:!0,...u,children:e.jsx(he.button,{"aria-describedby":s.open?s.contentId:void 0,"data-state":s.stateAttribute,...n,ref:l,onPointerMove:z(t.onPointerMove,h=>{h.pointerType!=="touch"&&!d.current&&!i.isPointerInTransitRef.current&&(s.onTriggerEnter(),d.current=!0)}),onPointerLeave:z(t.onPointerLeave,()=>{s.onTriggerLeave(),d.current=!1}),onPointerDown:z(t.onPointerDown,()=>{s.open&&s.onClose(),m.current=!0,document.addEventListener("pointerup",x,{once:!0})}),onFocus:z(t.onFocus,()=>{m.current||s.onOpen()}),onBlur:z(t.onBlur,s.onClose),onClick:z(t.onClick,s.onClose)})})});pt.displayName=_e;var Be="TooltipPortal",[Xr,Jr]=be(Be,{forceMount:void 0}),mt=t=>{const{__scopeTooltip:r,forceMount:a,children:n,container:s}=t,i=ae(Be,r);return e.jsx(Xr,{scope:r,forceMount:a,children:e.jsx(Se,{present:a||i.open,children:e.jsx(Ft,{asChild:!0,container:s,children:n})})})};mt.displayName=Be;var J="TooltipContent",ht=o.forwardRef((t,r)=>{const a=Jr(J,t.__scopeTooltip),{forceMount:n=a.forceMount,side:s="top",...i}=t,u=ae(J,t.__scopeTooltip);return e.jsx(Se,{present:n||u.open,children:u.disableHoverableContent?e.jsx(xt,{side:s,...i,ref:r}):e.jsx(Wr,{side:s,...i,ref:r})})}),Wr=o.forwardRef((t,r)=>{const a=ae(J,t.__scopeTooltip),n=Oe(J,t.__scopeTooltip),s=o.useRef(null),i=xe(r,s),[u,f]=o.useState(null),{trigger:l,onClose:m}=a,d=s.current,{onPointerInTransitChange:x}=n,h=o.useCallback(()=>{f(null),x(!1)},[x]),g=o.useCallback((j,w)=>{const N=j.currentTarget,v={x:j.clientX,y:j.clientY},C=ta(v,N.getBoundingClientRect()),E=ra(v,C),T=aa(w.getBoundingClientRect()),A=na([...E,...T]);f(A),x(!0)},[x]);return o.useEffect(()=>()=>h(),[h]),o.useEffect(()=>{if(l&&d){const j=N=>g(N,d),w=N=>g(N,l);return l.addEventListener("pointerleave",j),d.addEventListener("pointerleave",w),()=>{l.removeEventListener("pointerleave",j),d.removeEventListener("pointerleave",w)}}},[l,d,g,h]),o.useEffect(()=>{if(u){const j=w=>{const N=w.target,v={x:w.clientX,y:w.clientY},C=l?.contains(N)||d?.contains(N),E=!sa(v,u);C?h():E&&(h(),m())};return document.addEventListener("pointermove",j),()=>document.removeEventListener("pointermove",j)}},[l,d,u,m,h]),e.jsx(xt,{...t,ref:i})}),[Qr,Zr]=be(te,{isInside:!1}),ea=Bt("TooltipContent"),xt=o.forwardRef((t,r)=>{const{__scopeTooltip:a,children:n,"aria-label":s,onEscapeKeyDown:i,onPointerDownOutside:u,...f}=t,l=ae(J,a),m=ye(a),{onClose:d}=l;return o.useEffect(()=>(document.addEventListener(Ae,d),()=>document.removeEventListener(Ae,d)),[d]),o.useEffect(()=>{if(l.trigger){const x=h=>{h.target?.contains(l.trigger)&&d()};return window.addEventListener("scroll",x,{capture:!0}),()=>window.removeEventListener("scroll",x,{capture:!0})}},[l.trigger,d]),e.jsx(Ot,{asChild:!0,disableOutsidePointerEvents:!1,onEscapeKeyDown:i,onPointerDownOutside:u,onFocusOutside:x=>x.preventDefault(),onDismiss:d,children:e.jsxs(Zt,{"data-state":l.stateAttribute,...m,...f,ref:r,style:{...f.style,"--radix-tooltip-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-tooltip-content-available-width":"var(--radix-popper-available-width)","--radix-tooltip-content-available-height":"var(--radix-popper-available-height)","--radix-tooltip-trigger-width":"var(--radix-popper-anchor-width)","--radix-tooltip-trigger-height":"var(--radix-popper-anchor-height)"},children:[e.jsx(ea,{children:n}),e.jsx(Qr,{scope:a,isInside:!0,children:e.jsx(Yt,{id:l.contentId,role:"tooltip",children:s||n})})]})})});ht.displayName=J;var gt="TooltipArrow",ft=o.forwardRef((t,r)=>{const{__scopeTooltip:a,...n}=t,s=ye(a);return Zr(gt,a).isInside?null:e.jsx(Qt,{...s,...n,ref:r})});ft.displayName=gt;function ta(t,r){const a=Math.abs(r.top-t.y),n=Math.abs(r.bottom-t.y),s=Math.abs(r.right-t.x),i=Math.abs(r.left-t.x);switch(Math.min(a,n,s,i)){case i:return"left";case s:return"right";case a:return"top";case n:return"bottom";default:throw new Error("unreachable")}}function ra(t,r,a=5){const n=[];switch(r){case"top":n.push({x:t.x-a,y:t.y+a},{x:t.x+a,y:t.y+a});break;case"bottom":n.push({x:t.x-a,y:t.y-a},{x:t.x+a,y:t.y-a});break;case"left":n.push({x:t.x+a,y:t.y-a},{x:t.x+a,y:t.y+a});break;case"right":n.push({x:t.x-a,y:t.y-a},{x:t.x-a,y:t.y+a});break}return n}function aa(t){const{top:r,right:a,bottom:n,left:s}=t;return[{x:s,y:r},{x:a,y:r},{x:a,y:n},{x:s,y:n}]}function sa(t,r){const{x:a,y:n}=t;let s=!1;for(let i=0,u=r.length-1;i<r.length;u=i++){const f=r[i],l=r[u],m=f.x,d=f.y,x=l.x,h=l.y;d>n!=h>n&&a<(x-m)*(n-d)/(h-d)+m&&(s=!s)}return s}function na(t){const r=t.slice();return r.sort((a,n)=>a.x<n.x?-1:a.x>n.x?1:a.y<n.y?-1:a.y>n.y?1:0),oa(r)}function oa(t){if(t.length<=1)return t.slice();const r=[];for(let n=0;n<t.length;n++){const s=t[n];for(;r.length>=2;){const i=r[r.length-1],u=r[r.length-2];if((i.x-u.x)*(s.y-u.y)>=(i.y-u.y)*(s.x-u.x))r.pop();else break}r.push(s)}r.pop();const a=[];for(let n=t.length-1;n>=0;n--){const s=t[n];for(;a.length>=2;){const i=a[a.length-1],u=a[a.length-2];if((i.x-u.x)*(s.y-u.y)>=(i.y-u.y)*(s.x-u.x))a.pop();else break}a.push(s)}return a.pop(),r.length===1&&a.length===1&&r[0].x===a[0].x&&r[0].y===a[0].y?r:r.concat(a)}var ia=dt,ca=ut,la=pt,da=mt,ua=ht,pa=ft;function Re({delayDuration:t=0,...r}){return e.jsx(ia,{"data-slot":"tooltip-provider",delayDuration:t,...r})}function le({...t}){return e.jsx(Re,{children:e.jsx(ca,{"data-slot":"tooltip",...t})})}function de({...t}){return e.jsx(la,{"data-slot":"tooltip-trigger",...t})}function ue({className:t,sideOffset:r=0,children:a,...n}){return e.jsx(da,{children:e.jsxs(ua,{"data-slot":"tooltip-content",sideOffset:r,className:re("bg-foreground text-background animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 w-fit origin-(--radix-tooltip-content-transform-origin) rounded-md px-3 py-1.5 text-xs text-balance",t),...n,children:[a,e.jsx(pa,{className:"bg-foreground fill-foreground z-50 size-2.5 translate-y-[calc(-50%_-_2px)] rotate-45 rounded-[2px]"})]})})}function ma({articles:t,articlesAmount:r,setEditingArticle:a,handleDeleteArticle:n}){return!t||t.length===0?e.jsx(X,{className:"border-dashed",children:e.jsxs(L,{className:"flex flex-col items-center justify-center py-12",children:[e.jsx("div",{className:"rounded-lg bg-muted p-3 mb-4",children:e.jsx(Ie,{className:"h-8 w-8 text-muted-foreground"})}),e.jsx("h3",{className:"text-sm font-semibold mb-1",children:"No articles available"}),e.jsx("p",{className:"text-sm text-muted-foreground text-center max-w-xs",children:"Start creating articles to populate this list"})]})}):e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold tracking-tight",children:"Articles"}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Manage your published articles (",r,")"]})]})}),e.jsx("ul",{className:"grid gap-4 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4",children:t.map(s=>e.jsx("li",{className:"group",children:e.jsxs(X,{className:"h-full overflow-hidden flex flex-col transition-all duration-200 hover:shadow-lg hover:border-primary/50",children:[e.jsxs("div",{className:"relative w-full h-48 bg-muted overflow-hidden flex-shrink-0",children:[s.banner?e.jsx("img",{src:`${Le}${s.banner}`,alt:s.title,className:"w-full h-full object-cover group-hover:scale-110 transition-transform duration-300"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center bg-gradient-to-br from-muted via-muted to-muted-foreground/20",children:e.jsx(Ie,{className:"h-12 w-12 text-muted-foreground/30"})}),e.jsx("div",{className:"absolute inset-0 bg-black/0 group-hover:bg-black/10 transition-colors"}),e.jsxs("div",{className:"absolute top-2 right-2 flex gap-2",children:[s.featured&&e.jsx(Re,{children:e.jsxs(le,{children:[e.jsx(de,{asChild:!0,children:e.jsxs(Y,{className:"bg-yellow-500 hover:bg-yellow-600 text-black",children:[e.jsx(gr,{className:"h-3 w-3 mr-1"}),"Featured"]})}),e.jsx(ue,{children:"This article is featured"})]})}),e.jsxs(Y,{className:"bg-black/60 hover:bg-black/80 backdrop-blur-sm",children:["#",s.id]})]})]}),e.jsxs(Me,{className:"pb-2",children:[e.jsx(De,{className:"text-sm font-semibold line-clamp-2 group-hover:text-primary transition-colors duration-200",children:s.title}),s.createdAt&&e.jsxs($e,{className:"flex items-center gap-1 text-xs mt-1",children:[e.jsx(sr,{className:"h-3 w-3"}),new Date(s.createdAt).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})]})]}),e.jsxs(L,{className:"pb-3 flex-1 space-y-3",children:[e.jsx("p",{className:"text-xs text-muted-foreground line-clamp-3 leading-relaxed",children:s.content?.substring(0,120)||"No content available"}),e.jsx("div",{className:"space-y-2",children:s.categories&&s.categories.length>0?e.jsxs("div",{className:"flex flex-wrap gap-1",children:[s.categories.slice(0,3).map(i=>e.jsx(Y,{variant:"secondary",className:"text-xs font-medium",children:i.name},i.id)),s.categories.length>3&&e.jsxs(Y,{variant:"outline",className:"text-xs",children:["+",s.categories.length-3]})]}):e.jsx("div",{className:"inline-flex",children:e.jsx(Y,{variant:"outline",className:"text-xs opacity-50",children:"No categories"})})}),e.jsxs("div",{className:"flex items-center gap-2 pt-2 border-t border-border",children:[e.jsx(zt,{className:"h-3 w-3 text-muted-foreground"}),e.jsx("span",{className:"text-xs text-muted-foreground",children:"Author ID:"}),e.jsx(Y,{variant:"outline",className:"text-xs font-mono",children:s.authorId})]})]}),e.jsx(Gt,{className:"gap-2 pt-3 border-t border-border bg-muted/30",children:e.jsxs(Re,{children:[e.jsxs(le,{children:[e.jsx(de,{asChild:!0,children:e.jsxs(I,{onClick:()=>a(s),className:"flex-1 gap-1.5 cursor-pointer",variant:"default",size:"sm",children:[e.jsx(Ze,{className:"h-3.5 w-3.5"}),e.jsx("span",{className:"hidden sm:inline",children:"Edit"})]})}),e.jsx(ue,{children:"Edit this article"})]}),e.jsxs(le,{children:[e.jsx(de,{asChild:!0,children:e.jsx(I,{asChild:!0,variant:"outline",size:"sm",className:"flex-1 gap-1.5",children:e.jsxs(Ut,{to:`/article/${s.id}`,children:[e.jsx(We,{className:"h-3.5 w-3.5"}),e.jsx("span",{className:"hidden sm:inline",children:"View"})]})})}),e.jsx(ue,{children:"View article on site"})]}),e.jsxs(le,{children:[e.jsx(de,{asChild:!0,children:e.jsxs(I,{onClick:()=>n(s.id),className:"flex-1 gap-1.5 cursor-pointer",variant:"destructive",size:"sm",children:[e.jsx(et,{className:"h-3.5 w-3.5"}),e.jsx("span",{className:"hidden sm:inline",children:"Delete"})]})}),e.jsx(ue,{children:"Delete this article"})]})]})})]})},s.id))})]})}function Ta(){const{token:t,isAuthenticated:r}=me(),{articles:a,loading:n,error:s,fetchArticles:i,createNewArticle:u,updateExistingArticle:f,deleteArticle:l}=Ht(),{tempId:m,tempIdToken:d,loading:x,error:h,fetchTempId:g}=Pr(),{uploadNewImage:j,loading:w,error:N}=Nr(),{categories:v,loading:C,addCategory:E,removeCategory:T,updateCategoryData:A}=Sr(),[y,P]=o.useState({title:"",content:"",tempId:"",banner:null,featured:!1}),[F,se]=o.useState(null),[Q,H]=o.useState({name:"",description:""}),[q,G]=o.useState([]),[ne,O]=o.useState(0),[K,b]=o.useState(8),[D,_]=o.useState(1),R=Math.ceil(a.length/K),oe=a.sort((c,p)=>new Date(p.createdAt)-new Date(c.createdAt)).slice(ne,ne+K),[ie,ze]=o.useState(0),[ce,ha]=o.useState(3),[Ue,He]=o.useState(1),Z=Math.ceil(v.length/ce);console.log("categoriesTotalPages:",Z);const bt=v.sort((c,p)=>c.name.localeCompare(p.name)).slice(ie,ie+ce),V=o.useRef(null),je=o.useRef(null);o.useEffect(()=>{const c=setInterval(()=>{r&&t&&(k.info("Your session has expired. Please log in again."),window.location.reload())},6e5);return()=>clearInterval(c)},[]),o.useEffect(()=>{m?P(c=>({...c,tempId:m})):g?.()},[m]),o.useEffect(()=>{Ue>Z&&(He(c=>c>1?c-1:1),ze(c=>c>0?c-ce:0)),D>R&&(_(c=>c>1?c-1:1),O(c=>c>0?c-K:0))},[Z,R]);const yt=c=>{_(c),O((c-1)*K)},vt=c=>{He(c),ze((c-1)*ce)},jt=c=>{const{name:p,value:S,files:B}=c.target;P(p==="banner"?Te=>({...Te,banner:B?.[0]??null}):Te=>({...Te,[p]:S}))},Ct=()=>{Ne(!1),ke(null),P({title:"",content:"",tempId:m||"",banner:null,featured:!1}),G([]),V.current&&(V.current.value=""),k.info("Article editing cancelled")},Nt=c=>{const{files:p}=c.target;p&&p[0]&&se(p[0])},wt=c=>{if(!c){k.info("Category editing cancelled"),we(!1),H({id:null,name:"",description:""});return}k.info(`Category "${c.name}" loaded for editing (ID: ${c.id})`),we(!0),H({id:c.id,name:c.name,description:c.description})},kt=c=>{const{name:p,value:S}=c.target;H(B=>({...B,[p]:S}))},Tt=async c=>{c.preventDefault();try{const p=await E(Q);H({name:"",description:""}),k.success("Categoría creada")}catch{k.error("Error creando categoría")}},Pt=async c=>{c.preventDefault();try{await A(Q),H({name:"",description:"",id:null}),we(!1),k.success("Category updated")}catch(p){k.error("Error updating category"),console.error(p)}},Et=async c=>{if(window.confirm("¿Eliminar esta categoría?"))try{await T(c),k.success("Categoría eliminada")}catch{k.error("Error eliminando categoría")}},It=c=>{const p=Number(c.target.value);G(S=>c.target.checked?[...S,p]:S.filter(B=>B!==p))},At=async c=>{c.preventDefault();try{const p=new FormData;p.append("title",y.title),p.append("content",y.content),p.append("tempId",y.tempId),p.append("featured",y.featured?"true":"false"),y.banner&&p.append("banner",y.banner),p.append("categoryIds",JSON.stringify(q)),console.log("Submitting article with data:",{title:y.title,content:y.content,tempId:y.tempId,featured:y.featured,banner:y.banner,categoryIds:q}),await u(p,d),k.success("Article created successfully"),P({title:"",content:"",tempId:m||"",banner:null,featured:!1}),G([]),V.current&&(V.current.value=""),i?.()}catch(p){console.error("Error creating article:",p),k.error("Error creating article")}},_t=async c=>{if(c.preventDefault(),!!F)try{const p=new FormData;p.append("image",F),p.append("tempId",m),Ce&&p.append("articleId",ee);const S=await j(p,d);k.success("Image uploaded successfully"),se(null),je.current&&(je.current.value=""),P(B=>({...B,content:B.content+`
![alt text](${Le}${S.url})`}))}catch(p){console.error("Error uploading image:",p),k.error("Error uploading image")}},Rt=c=>{k.info("Article has been loaded to the form for editing"),ke(c.id),console.log("Editing article:",c),P({title:c.title,content:c.content,tempId:c.tempId||"",banner:c.banner||null,featured:c.featured}),G(c.categories.map(p=>p.id)),Ne(!0)},St=async c=>{if(window.confirm("Are you sure you want to delete this article?"))try{await l(c),i?.()}catch(p){console.error("Error deleting article:",p),k.error("Error deleting article")}},qe=async c=>{if(c.preventDefault(),!ee){k.error("No article selected for editing");return}const p=new FormData;p.append("title",y.title),p.append("content",y.content),p.append("tempId",y.tempId),p.append("featured",y.featured?"true":"false"),p.append("articleId",ee),console.log("featured value:",y.featured),console.log("featured is boolean:",typeof y.featured=="boolean"),y.banner instanceof File?p.append("banner",y.banner):y.banner&&typeof y.banner=="string"&&p.append("existingBanner",y.banner),p.append("categoryIds",JSON.stringify(q));try{console.log("Editing article with data:",{title:y.title,content:y.content,tempId:y.tempId,featured:y.featured,banner:y.banner,articleId:ee,categoryIds:q}),await f(ee,p,d),k.success("Article updated successfully"),P({title:"",content:"",tempId:m||"",banner:null,featured:!1}),ke(null),G([]),Ne(!1),V.current&&(V.current.value=""),i?.()}catch(S){console.error("Error updating article:",S),k.error("Error updating article")}},[Ce,Ne]=o.useState(!1),[Lt,we]=o.useState(!1),[ee,ke]=o.useState(null),Ge=n||x,Mt=w||x;return e.jsx("div",{className:"p-4 space-y-6 max-w-7xl mx-auto",children:e.jsxs(er,{cascade:!0,damping:.05,triggerOnce:!0,duration:400,children:[e.jsx(Fr,{tempIdError:h,articleError:s,imageError:N}),e.jsx(qr,{formData:y,onChange:jt,bannerInputRef:V,imageInputRef:je,handleImageChange:Nt,handleImageUpload:_t,imageData:F,isUploadingImage:Mt,handleSubmit:At,isSubmittingArticle:Ge,categories:v,selectedCategories:q,handleCategoryCheckbox:It,isEditing:Ce,cancelEditArticle:Ct,handleSubmitEdit:qe}),e.jsx(Pe,{}),e.jsx(Gr,{categoryForm:Q,onCategoryFormChange:kt,onCategorySubmit:Tt,onEditCategory:wt,categories:bt,categoryAmount:v.length,categoriesLoading:C,onDeleteCategory:Et,isEditingCategory:Lt,onEditCategorySubmit:Pt}),Z>1&&e.jsx(Ee,{currentPage:Ue,totalPages:Z,onPageChange:vt}),e.jsx(Pe,{}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h3",{className:"text-lg font-bold",children:"Existing Articles"}),e.jsx(ma,{articles:oe,articlesAmount:a.length,setEditingArticle:Rt,handleSubmitEdit:qe,isSubmittingArticle:Ge,isEditing:Ce,handleDeleteArticle:St})]}),R>1&&e.jsx(Ee,{currentPage:D,totalPages:R,onPageChange:yt})]})})}export{Ta as default};
