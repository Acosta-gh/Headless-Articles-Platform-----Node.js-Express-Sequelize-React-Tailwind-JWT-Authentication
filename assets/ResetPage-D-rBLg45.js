import{c as q,t as K,s as z,r as t,j as e,I as v,q as y,z as A,L as B}from"./index-4Xp8Ba2F.js";import{C as O,a as U,b as Y,d as _,e as G}from"./card-C86A7I4G.js";import{L as b,E as C}from"./label-B6Sb77Vz.js";import{a as H,C as w}from"./circle-x-hvgEySWZ.js";/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const V=[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],k=q("eye-off",V);function W(){const{reset:S,loading:n}=K(),p=z(),[i,E]=t.useState(null),[r,R]=t.useState(""),[c,L]=t.useState(""),[m,I]=t.useState(!1),[x,T]=t.useState(!1),[h,l]=t.useState(""),[o,g]=t.useState(!1),[f,u]=t.useState(null);t.useEffect(()=>{let s=null;if(s=new URLSearchParams(window.location.search).get("token"),!s){const d=window.location.hash,M=d.includes("?")?d.slice(d.indexOf("?")):"";s=new URLSearchParams(M).get("token")}console.log("Token detected:",s),E(s),s||u("Invalid or missing reset token")},[]),t.useEffect(()=>{if(o){const s=setTimeout(()=>{p("/login")},2e3);return()=>clearTimeout(s)}},[o,p]);const j=s=>s.length<8?"Password must be at least 8 characters long":/[A-Z]/.test(s)?/[a-z]/.test(s)?/[0-9]/.test(s)?null:"Password must contain at least one number":"Password must contain at least one lowercase letter":"Password must contain at least one uppercase letter",F=s=>{const a=s.target.value;if(R(a),a){const d=j(a);l(d||"")}else l("")},N=async()=>{if(l(""),u(null),console.log("ðŸš€ Submitting reset password..."),!r||!c){l("Please fill in all fields");return}const s=j(r);if(s){l(s);return}if(r!==c){l("Passwords do not match");return}if(!i){l("Invalid or missing reset token");return}console.log("ðŸ“¦ Calling reset with:",{token:i.substring(0,10)+"...",password:"***"});const a=await S({token:i,password:r});console.log("ðŸ“¨ Reset result:",a),a.success?(console.log("âœ… Password reset successful"),g(!0),u(null)):(console.log("âŒ Password reset failed:",a.error),u(a.error),g(!1))},P=s=>{s.key==="Enter"&&!n&&N()};return e.jsx("div",{className:"flex items-center justify-center min-h-screen bg-muted/30 p-4",children:e.jsxs(O,{className:"w-full max-w-md shadow-md",children:[e.jsx(U,{children:e.jsx(Y,{className:"text-2xl font-semibold text-center",children:o?"Password Reset Successful":n?"Resetting Password...":"Reset Your Password"})}),e.jsxs(_,{className:"space-y-4",children:[o&&e.jsxs("div",{className:"flex flex-col items-center space-y-2 py-4",children:[e.jsx(H,{className:"w-12 h-12 text-green-600"}),e.jsx("p",{className:"text-green-600 font-medium text-center",children:"Your password has been successfully reset!"}),e.jsx("p",{className:"text-sm text-muted-foreground text-center",children:"Redirecting to login..."})]}),f&&!o&&e.jsxs("div",{className:"flex flex-col items-center space-y-2 py-4",children:[e.jsx(w,{className:"w-10 h-10 text-destructive"}),e.jsx("p",{className:"text-destructive font-medium text-center",children:f})]}),!o&&!f&&i&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(b,{htmlFor:"password",children:"New Password"}),e.jsxs("div",{className:"relative",children:[e.jsx(v,{id:"password",type:m?"text":"password",placeholder:"Enter your new password",value:r,onChange:F,onKeyPress:P,disabled:n,className:h&&r?"border-destructive":""}),e.jsx("button",{type:"button",onClick:()=>I(!m),className:"absolute right-3 top-1/2 -translate-y-1/2 text-muted-foreground hover:text-foreground",children:m?e.jsx(k,{className:"w-4 h-4"}):e.jsx(C,{className:"w-4 h-4"})})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Must be at least 8 characters with uppercase, lowercase, and numbers"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(b,{htmlFor:"confirmPassword",children:"Confirm Password"}),e.jsxs("div",{className:"relative",children:[e.jsx(v,{id:"confirmPassword",type:x?"text":"password",placeholder:"Confirm your new password",value:c,onChange:s=>L(s.target.value),onKeyPress:P,disabled:n,className:c&&r!==c?"border-destructive":""}),e.jsx("button",{type:"button",onClick:()=>T(!x),className:"absolute right-3 top-1/2 -translate-y-1/2 text-muted-foreground hover:text-foreground",children:x?e.jsx(k,{className:"w-4 h-4"}):e.jsx(C,{className:"w-4 h-4"})})]})]}),h&&e.jsxs("div",{className:"flex items-start space-x-2 p-3 bg-destructive/10 rounded-md",children:[e.jsx(w,{className:"w-5 h-5 text-destructive flex-shrink-0 mt-0.5"}),e.jsx("p",{className:"text-sm text-destructive",children:h})]}),e.jsx(y,{onClick:N,className:"w-full",disabled:n||!r||!c,children:n?e.jsxs(e.Fragment,{children:[e.jsx(A,{className:"w-4 h-4 mr-2 animate-spin"}),"Resetting Password..."]}):"Reset Password"})]}),!i&&!o&&e.jsxs("div",{className:"flex flex-col items-center space-y-2 py-4",children:[e.jsx(w,{className:"w-10 h-10 text-destructive"}),e.jsx("p",{className:"text-destructive font-medium text-center",children:"Invalid or missing reset token"}),e.jsx("p",{className:"text-sm text-muted-foreground text-center",children:"Please request a new password reset link"})]})]}),e.jsx(G,{className:"flex justify-center",children:e.jsx(y,{variant:"ghost",asChild:!0,disabled:n,children:e.jsx(B,{to:"/login",children:o?"Go to Login":"Back to Login"})})})]})})}export{W as default};
